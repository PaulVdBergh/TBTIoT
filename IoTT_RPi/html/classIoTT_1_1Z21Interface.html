<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IoTings and Trains: IoTT::Z21Interface Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IoTings and Trains
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classIoTT_1_1Z21Interface.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classIoTT_1_1Z21Interface-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">IoTT::Z21Interface Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Z21Interface_8h_source.html">Z21Interface.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for IoTT::Z21Interface:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classIoTT_1_1Z21Interface.png" usemap="#IoTT::Z21Interface_map" alt=""/>
  <map id="IoTT::Z21Interface_map" name="IoTT::Z21Interface_map">
<area href="classIoTT_1_1MqttSubscription.html" alt="IoTT::MqttSubscription" shape="rect" coords="0,0,135,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a10d5e45be47f7d9a17567d12bb5db2d3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a10d5e45be47f7d9a17567d12bb5db2d3">Z21Interface</a> (in_port_t port=21105, const string &amp;topicBasePath=&quot;IoTT/&quot;)</td></tr>
<tr class="separator:a10d5e45be47f7d9a17567d12bb5db2d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49ba7d835312d0f11bc61143410cf373"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a49ba7d835312d0f11bc61143410cf373">~Z21Interface</a> ()</td></tr>
<tr class="separator:a49ba7d835312d0f11bc61143410cf373"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94dfc1d0b95d6217912c04127dba95f2"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a94dfc1d0b95d6217912c04127dba95f2">sendToSocket</a> (const uint8_t *pMsg, sockaddr *address)</td></tr>
<tr class="separator:a94dfc1d0b95d6217912c04127dba95f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacab731304b340d69606b397a62a83aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#aacab731304b340d69606b397a62a83aa">broadcastPowerStateChange</a> (const bool &amp;newState)</td></tr>
<tr class="separator:aacab731304b340d69606b397a62a83aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64204cc5a7b4a99e1d6f70c28139cb06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a64204cc5a7b4a99e1d6f70c28139cb06">broadcastAccessoryInfoChanged</a> (<a class="el" href="classIoTT_1_1Accessory.html">Accessory</a> *pAccessory)</td></tr>
<tr class="separator:a64204cc5a7b4a99e1d6f70c28139cb06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee490b2f7934a38f04dbc88708e89285"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#aee490b2f7934a38f04dbc88708e89285">broadcastEmergencyStop</a> (void)</td></tr>
<tr class="separator:aee490b2f7934a38f04dbc88708e89285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b1ca4967ca8e7771f06789e9672cfa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a55b1ca4967ca8e7771f06789e9672cfa">broadcastOvercurrent</a> (void)</td></tr>
<tr class="separator:a55b1ca4967ca8e7771f06789e9672cfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcb6084a5d89a8fb1f32fdb81009a90e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#adcb6084a5d89a8fb1f32fdb81009a90e">OnNewData</a> (const <a class="el" href="classIoTT_1_1mqttMessageQueueItem.html">mqttMessageQueueItem</a> &amp;item) override</td></tr>
<tr class="separator:adcb6084a5d89a8fb1f32fdb81009a90e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74bcabc2f7aef6df8a10b12ddf924c20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a74bcabc2f7aef6df8a10b12ddf924c20">broadcastLocInfoChanged</a> (<a class="el" href="classIoTT_1_1LocDecoder.html">LocDecoder</a> *pLoc)</td></tr>
<tr class="separator:a74bcabc2f7aef6df8a10b12ddf924c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classIoTT_1_1MqttSubscription"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classIoTT_1_1MqttSubscription')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classIoTT_1_1MqttSubscription.html">IoTT::MqttSubscription</a></td></tr>
<tr class="memitem:a97c600c8bd24e69b5f9cc9a6bea767a7 inherit pub_methods_classIoTT_1_1MqttSubscription"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1MqttSubscription.html#a97c600c8bd24e69b5f9cc9a6bea767a7">MqttSubscription</a> (const char *topic)</td></tr>
<tr class="separator:a97c600c8bd24e69b5f9cc9a6bea767a7 inherit pub_methods_classIoTT_1_1MqttSubscription"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59507385afe48df7f1c5d3d509c3509e inherit pub_methods_classIoTT_1_1MqttSubscription"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1MqttSubscription.html#a59507385afe48df7f1c5d3d509c3509e">~MqttSubscription</a> ()</td></tr>
<tr class="separator:a59507385afe48df7f1c5d3d509c3509e inherit pub_methods_classIoTT_1_1MqttSubscription"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7e587fbdf5cf104f38c2c7e15a5b912 inherit pub_methods_classIoTT_1_1MqttSubscription"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1MqttSubscription.html#ad7e587fbdf5cf104f38c2c7e15a5b912">isTopicMatched</a> (const <a class="el" href="classIoTT_1_1mqttMessageQueueItem.html">mqttMessageQueueItem</a> &amp;item)</td></tr>
<tr class="separator:ad7e587fbdf5cf104f38c2c7e15a5b912 inherit pub_methods_classIoTT_1_1MqttSubscription"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a51664ae9f82efff951003723efbcd55b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIoTT_1_1Z21Client.html">Z21Client</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a51664ae9f82efff951003723efbcd55b">findClient</a> (const sockaddr_in &amp;address)</td></tr>
<tr class="separator:a51664ae9f82efff951003723efbcd55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16fbab8afaaa86a2c93624238f933631"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a16fbab8afaaa86a2c93624238f933631">removeClient</a> (<a class="el" href="classIoTT_1_1Z21Client.html">Z21Client</a> *pClient)</td></tr>
<tr class="separator:a16fbab8afaaa86a2c93624238f933631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81a8f1e4962c7b47849ec233dd1364af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIoTT_1_1Decoder.html">Decoder</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a81a8f1e4962c7b47849ec233dd1364af">findDecoder</a> (const <a class="el" href="namespaceIoTT.html#a31b8cd9473fc447b3fb341b78afa54fe">DCCAddress_t</a> &amp;address)</td></tr>
<tr class="separator:a81a8f1e4962c7b47849ec233dd1364af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a6dd3e3e6c925e4cc09efa1b219936428"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a6dd3e3e6c925e4cc09efa1b219936428">threadFunc</a> (void)</td></tr>
<tr class="separator:a6dd3e3e6c925e4cc09efa1b219936428"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae978137ddd81489343ac8486d74d921a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIoTT_1_1Decoders.html">Decoders</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#ae978137ddd81489343ac8486d74d921a">m_pDecoders</a></td></tr>
<tr class="separator:ae978137ddd81489343ac8486d74d921a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d755ba0c08a8c5dc79357e9093e980"><td class="memItemLeft" align="right" valign="top">const string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a88d755ba0c08a8c5dc79357e9093e980">m_TopicBasePath</a></td></tr>
<tr class="separator:a88d755ba0c08a8c5dc79357e9093e980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a303f4581893ff5b9808fda50a428ef4c"><td class="memItemLeft" align="right" valign="top">in_port_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a303f4581893ff5b9808fda50a428ef4c">m_port</a></td></tr>
<tr class="separator:a303f4581893ff5b9808fda50a428ef4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae87188b5116702638ac12db408cb8fa2"><td class="memItemLeft" align="right" valign="top">thread&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#ae87188b5116702638ac12db408cb8fa2">m_thread</a></td></tr>
<tr class="separator:ae87188b5116702638ac12db408cb8fa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5136979b4f41f3fabdc2ee5818b0c71"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#ad5136979b4f41f3fabdc2ee5818b0c71">m_fdStop</a></td></tr>
<tr class="separator:ad5136979b4f41f3fabdc2ee5818b0c71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adefd2315595c417c3ed51e2ccc06edbc"><td class="memItemLeft" align="right" valign="top">sockaddr_in&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#adefd2315595c417c3ed51e2ccc06edbc">m_sockaddr_me</a></td></tr>
<tr class="separator:adefd2315595c417c3ed51e2ccc06edbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a644498b25a639cc18b7a0ba1d30e15e3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a644498b25a639cc18b7a0ba1d30e15e3">m_fdsock_me</a></td></tr>
<tr class="separator:a644498b25a639cc18b7a0ba1d30e15e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1212b3351e13f38619bb11dc56f689cd"><td class="memItemLeft" align="right" valign="top">recursive_mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a1212b3351e13f38619bb11dc56f689cd">m_Mfdsock_me</a></td></tr>
<tr class="separator:a1212b3351e13f38619bb11dc56f689cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d2a91c8058d1cf26c19cd8db9a2ca1"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="classIoTT_1_1Z21Client.html">Z21Client</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#a95d2a91c8058d1cf26c19cd8db9a2ca1">m_Clients</a></td></tr>
<tr class="separator:a95d2a91c8058d1cf26c19cd8db9a2ca1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac03305fbb3face4b0db005087d5fc426"><td class="memItemLeft" align="right" valign="top">recursive_mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1Z21Interface.html#ac03305fbb3face4b0db005087d5fc426">m_MClients</a></td></tr>
<tr class="separator:ac03305fbb3face4b0db005087d5fc426"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classIoTT_1_1MqttSubscription"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classIoTT_1_1MqttSubscription')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classIoTT_1_1MqttSubscription.html">IoTT::MqttSubscription</a></td></tr>
<tr class="memitem:a244de1721c3ba52f3920bee00fa7f73b inherit pro_attribs_classIoTT_1_1MqttSubscription"><td class="memItemLeft" align="right" valign="top">const string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIoTT_1_1MqttSubscription.html#a244de1721c3ba52f3920bee00fa7f73b">m_Topic</a></td></tr>
<tr class="separator:a244de1721c3ba52f3920bee00fa7f73b inherit pro_attribs_classIoTT_1_1MqttSubscription"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class <a class="el" href="classIoTT_1_1Z21Interface.html">Z21Interface</a> represents the interface for UDP clients using the Z21 Lan Protocol.</p>
<h1>Basics</h1>
<h2>Communication:</h2>
<p>Communication with the Z21 protocol over UDP port 21105 or 21106. Control applications on the client (PC, App, ...) should primarily use port 21105. The communication is always asynchronous, i.e. between a request and the corresponding response other broadcast messages can occur.</p>
<p>It is expected that each client communicates with the Z21 once per minute, otherwise it will be removed from the list of active participants. If possible, a client should log off when exiting with the LAN_LOGOFF command.</p>
<h2>Z21 Datagram layout</h2>
<p>A Z21 datagram, i.e. a request or response is structured as follows:</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Z21 Datagram Layout</caption>
<tr>
<th>DataLen</th><th>Header</th><th>Data </th></tr>
<tr>
<td>2 Bytes</td><td>2 Bytes</td><td>n Bytes </td></tr>
</table>
<ul>
<li><p class="startli"><b>DataLen</b> (little endian):</p>
<p class="startli">Total length over the entire data set including DataLen, Header and Data, i.e. DataLen = 2 + 2 + n.</p>
</li>
<li><p class="startli"><b>Header</b> (little endian):</p>
<p class="startli">Describes the command or protocol group.</p>
</li>
<li><p class="startli"><b>Data</b>:</p>
<p class="startli">Structure and length depend on command. Exact description see respective command.</p>
</li>
</ul>
<p>Unless otherwise stated, the byte order is little-endian, i.e. first the low byte, then the high byte. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a10d5e45be47f7d9a17567d12bb5db2d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10d5e45be47f7d9a17567d12bb5db2d3">&#9670;&nbsp;</a></span>Z21Interface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IoTT::Z21Interface::Z21Interface </td>
          <td>(</td>
          <td class="paramtype">in_port_t&#160;</td>
          <td class="paramname"><em>port</em> = <code>21105</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>topicBasePath</em> = <code>&quot;IoTT/&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td></td></tr>
    <tr><td class="paramname">topicBasePath</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a49ba7d835312d0f11bc61143410cf373"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49ba7d835312d0f11bc61143410cf373">&#9670;&nbsp;</a></span>~Z21Interface()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IoTT::Z21Interface::~Z21Interface </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a64204cc5a7b4a99e1d6f70c28139cb06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64204cc5a7b4a99e1d6f70c28139cb06">&#9670;&nbsp;</a></span>broadcastAccessoryInfoChanged()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IoTT::Z21Interface::broadcastAccessoryInfoChanged </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIoTT_1_1Accessory.html">Accessory</a> *&#160;</td>
          <td class="paramname"><em>pAccessory</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pAccessory</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aee490b2f7934a38f04dbc88708e89285"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee490b2f7934a38f04dbc88708e89285">&#9670;&nbsp;</a></span>broadcastEmergencyStop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IoTT::Z21Interface::broadcastEmergencyStop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a74bcabc2f7aef6df8a10b12ddf924c20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74bcabc2f7aef6df8a10b12ddf924c20">&#9670;&nbsp;</a></span>broadcastLocInfoChanged()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IoTT::Z21Interface::broadcastLocInfoChanged </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIoTT_1_1LocDecoder.html">LocDecoder</a> *&#160;</td>
          <td class="paramname"><em>pLoc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pLoc</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a55b1ca4967ca8e7771f06789e9672cfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55b1ca4967ca8e7771f06789e9672cfa">&#9670;&nbsp;</a></span>broadcastOvercurrent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IoTT::Z21Interface::broadcastOvercurrent </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aacab731304b340d69606b397a62a83aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacab731304b340d69606b397a62a83aa">&#9670;&nbsp;</a></span>broadcastPowerStateChange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IoTT::Z21Interface::broadcastPowerStateChange </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>newState</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">newState</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a51664ae9f82efff951003723efbcd55b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51664ae9f82efff951003723efbcd55b">&#9670;&nbsp;</a></span>findClient()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIoTT_1_1Z21Client.html">Z21Client</a> * IoTT::Z21Interface::findClient </td>
          <td>(</td>
          <td class="paramtype">const sockaddr_in &amp;&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a81a8f1e4962c7b47849ec233dd1364af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81a8f1e4962c7b47849ec233dd1364af">&#9670;&nbsp;</a></span>findDecoder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIoTT_1_1Decoder.html">Decoder</a> * IoTT::Z21Interface::findDecoder </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceIoTT.html#a31b8cd9473fc447b3fb341b78afa54fe">DCCAddress_t</a> &amp;&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="adcb6084a5d89a8fb1f32fdb81009a90e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcb6084a5d89a8fb1f32fdb81009a90e">&#9670;&nbsp;</a></span>OnNewData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void IoTT::Z21Interface::OnNewData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classIoTT_1_1mqttMessageQueueItem.html">mqttMessageQueueItem</a> &amp;&#160;</td>
          <td class="paramname"><em>item</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">item</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classIoTT_1_1MqttSubscription.html#a9ddc697ad6a842bd88ec0e768d8a1d37">IoTT::MqttSubscription</a>.</p>

</div>
</div>
<a id="a16fbab8afaaa86a2c93624238f933631"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16fbab8afaaa86a2c93624238f933631">&#9670;&nbsp;</a></span>removeClient()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool IoTT::Z21Interface::removeClient </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIoTT_1_1Z21Client.html">Z21Client</a> *&#160;</td>
          <td class="paramname"><em>pClient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pClient</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a94dfc1d0b95d6217912c04127dba95f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94dfc1d0b95d6217912c04127dba95f2">&#9670;&nbsp;</a></span>sendToSocket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t IoTT::Z21Interface::sendToSocket </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pMsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">sockaddr *&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pMsg</td><td></td></tr>
    <tr><td class="paramname">address</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a6dd3e3e6c925e4cc09efa1b219936428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dd3e3e6c925e4cc09efa1b219936428">&#9670;&nbsp;</a></span>threadFunc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void IoTT::Z21Interface::threadFunc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<hr/>
 <h3>LAN_GET_SERIAL_NUMBER</h3>
<p>read the serial number from the Z21</p>
<a class="anchor" id="multi_row"></a>
<table class="doxtable">
<caption>request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td>0x04</td><td>0x00</td><td>0x10</td><td>0x00</td><td>&ndash; </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>response:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td>0x08</td><td>0x00</td><td>0x10</td><td>0x00</td><td>Serialnumber (32 bit, little endian) </td></tr>
</table>
<hr/>
 <h3>LAN_GET_CODE</h3>
<p>With this command, the SW feature scope of the Z21 can be checked and read out. This command is of particular interest for the hardware version "z21 start" in order to check whether driving and switching via LAN is blocked or allowed.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Header</th><th>Data </th></tr>
<tr>
<td>0x04</td><td>0x00</td><td>0x18</td><td>0x00</td><td>- </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Response:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Header</th><th>Data </th></tr>
<tr>
<td>0x05</td><td>0x00</td><td>0x18</td><td>0x00</td><td>Code (8 Bit) </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Code layout</caption>
<tr>
<th>define</th><th>Value</th><th>Meaning </th></tr>
<tr>
<td>Z21_NO_LOCK</td><td>0x00</td><td>No features locked </td></tr>
<tr>
<td>Z21_START_LOCKED</td><td>0x01</td><td>"z21 start" : Driving and switching disabled via LAN. </td></tr>
<tr>
<td>Z21_START_UNLOCKED</td><td>0x02</td><td>"z21 start" : all feature locks are removed </td></tr>
</table>
<hr/>
 <h3>LAN_GET_HWINFO</h3>
<p>With this command the hardware type and the firmware version of the Z21 can be read out.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Header</th><th>Data </th></tr>
<tr>
<td>0x04</td><td>0x00</td><td>0x1A</td><td>0x00</td><td>- </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Response:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Header</th><th colspan="2">Data </th></tr>
<tr>
<td>0x0C</td><td>0x00</td><td>0x1A</td><td>0x00</td><td>HwType 32 Bit(little endian)</td><td>FW Version 32 Bit (little endian) </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>HwType 32 Bit</caption>
<tr>
<th>define</th><th>Value</th><th>Meaning </th></tr>
<tr>
<td>D_HWT_Z21_OLD</td><td>0x00000200</td><td>"Black Z21" (Hardware-version from 2012) </td></tr>
<tr>
<td>D_HWT_Z21_NEW</td><td>0x00000201</td><td>"Black Z21" (Hardware-version from 2013) </td></tr>
<tr>
<td>D_HWT_SMARTRAIL</td><td>0x00000202</td><td>"SmartRail" (from 2012) </td></tr>
<tr>
<td>D_HWT_z21_SMALL</td><td>0x00000203</td><td>"White z21" Starterset-version (from 2013) </td></tr>
<tr>
<td>D_HWT_z21_START</td><td>0x00000204</td><td>"z21 start" Starterset-version (from 2016) </td></tr>
</table>
<p>The FW version is specified in BCD format.</p>
<hr/>
 <h3>LAN_LOGOFF</h3>
<p>Log off this client from the system</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td>0x04</td><td>0x00</td><td>0x30</td><td>0x00</td><td>&ndash; </td></tr>
</table>
<p>response: none</p>
<p>When logging out, use the same port number as when logging in.</p>
<p><b>Note</b>: logging in occurs implicitly with the client's first command (e.g. LAN_SYSTEM_STATE_GETDATA, ...).</p>
<hr/>
 <h3>LAN_GET_BROADCASTFLAGS</h3>
<p>Reading out the broadcast flags in the Z21.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td>0x04</td><td>0x00</td><td>0x51</td><td>0x00</td><td>&ndash; </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Response:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td>0x08</td><td>0x00</td><td>0x51</td><td>0x00</td><td>Broadcast-Flags (32 Bit little endian) </td></tr>
</table>
<p>Broadcast-Flags : see UDPClient::getBroadcastFlags</p>
<hr/>
 <h3>LAN_SYSTEMSTATE_GETDATA</h3>
<p>Request the current system state.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td>0x04</td><td>0x00</td><td>0x85</td><td>0x00</td><td>- </td></tr>
</table>
<p>response : see TBT::SystemState</p>
<hr/>
 <h3>LAN_LOCONET_FROM_LAN</h3>
<p><b>From Z21 FW version 1.20.</b></p>
<p>With this message, a LAN client can write a message to the LocoNet bus.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td rowspan="2">0x04 + n</td><td rowspan="2">0x00</td><td rowspan="2">0xA2</td><td rowspan="2">0x00</td><th>LocoNet message incl. CKSUM </th></tr>
<tr>
<td>n Bytes </td></tr>
</table>
<hr/>
 <h3>LAN_RMBUS_GETDATA</h3>
<p>Request the current status of the feedback.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td>0x05</td><td>0x00</td><td>0x81</td><td>0x00</td><td>Group index (1 Byte) </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Response:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th colspan="2">Data </th></tr>
<tr>
<td>0x0F</td><td>0x00</td><td>0x80</td><td>0x00</td><td>Group index (1 Byte)</td><td>Feedback status (10 bytes) </td></tr>
</table>
<p><b>Group index :</b></p><ul>
<li>0 &ndash;&gt; Feedback status for address from 1 to 10</li>
<li>1 &ndash;&gt; Feedback status for address from 11 to 20</li>
<li></li>
<li></li>
</ul>
<p><b>Feedback status :</b></p><ul>
<li>1 byte per feedback,</li>
<li>1 bit per input.</li>
</ul>
<p>The assignment of feedback address and byte position is statically ascending.</p>
<p><b>Example:</b> GroupIndex = 1 and feedback status = 0x01 0x00 0xC5 0x00 0x00 0x00 0x00 0x00 0x00 0x00 means "feedback 11, contact input 1; Feedback 13, contact input 8,7,3 and 1 "</p>
<hr/>
 <h3>LAN_RMBUS_PROGRAMMODULE</h3>
<p>Change the feedback address.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td>0x05</td><td>0x00</td><td>0x82</td><td>0x00</td><td>Address (1 Byte) </td></tr>
</table>
<p><b>Address:</b> new address for the feedback module to be programmed. Supported value range: 0 and 1 ... 20.</p>
<p>Response: none</p>
<dl class="section warning"><dt>Warning</dt><dd>The programming command is output on the R-BUS until this command is sent again to Z21 with address = 0. During the programming process, no other feedback module may be connected on the R-BUS.</dd></dl>
<hr/>
 <h3>LAN_GET_LOCOMODE</h3>
<p>Read the output format for a given locomotive address.</p>
<p>The output format (DCC, MM) can be stored persistently per locomotive address in the Z21. A maximum of 256 different locomotive addresses can be stored. Each address&gt; = 256 is automatically DCC.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td>0x06</td><td>0x00</td><td>0x60</td><td>0x00</td><td>Loc-Address (16 Bit <b>big endian</b>) </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Response:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th colspan="2">Data </th></tr>
<tr>
<td>0x07</td><td>0x00</td><td>0x60</td><td>0x00</td><td>Loc-Address (16 Bit <b>big endian</b>)</td><td>Modus (8 bit) </td></tr>
</table>
<p>Modus : see <a class="el" href="classIoTT_1_1LocDecoder.html#afe55555aa98e8bf36748676b81e3c01f">LocDecoder::getLocMode</a></p>
<hr/>
 <h3>LAN_X_SET_STOP</h3>
<p>With the following command the emergency stop is raised. All Locs goes into speedstep 01, but the power is still feed to the rails.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th colspan="2">Data </th></tr>
<tr>
<td rowspan="2">0x06</td><td rowspan="2">0x00</td><td rowspan="2">0x40</td><td rowspan="2">0x00</td><th>X-Header</th><th>XOR-Byte </th></tr>
<tr>
<td>0x80</td><td>0x80 </td></tr>
</table>
<p>response : see UDPClient::broadcastEmergencyStop</p>
<hr/>
 <h3>LAN_GET_TURNOUTMODE</h3>
<p>Reading the settings for a given function decoder address ("Function Decoder" in the sense of "Accessory Decoder" RP-9.2.1). The output format (DCC, MM) can be stored persistently per function decoder address in the Z21. A maximum of 256 different function decoder addresses can be stored. Each Address&gt; = 256 is automatically DCC.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th>Data </th></tr>
<tr>
<td>0x06</td><td>0x00</td><td>0x70</td><td>0x00</td><td>Function <a class="el" href="classIoTT_1_1Decoder.html">Decoder</a> Address (16 Bit <b>big endian</b>) </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Response:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th colspan="2">Data </th></tr>
<tr>
<td>0x07</td><td>0x00</td><td>0x70</td><td>0x00</td><td>Function <a class="el" href="classIoTT_1_1Decoder.html">Decoder</a> Address (16 Bit <b>big endian</b>)</td><td>Modus (8 Bit) </td></tr>
</table>
<p>Modus : see FunctionDecoder::getMode</p>
<p>At the LAN interface and in the Z21, the function decoder addresses are addressed from 0, in the visualization on the apps or on the multiMaus, however, from 1. This is merely a decision of the visualization. Example: multiMaus switch address # 3, corresponds on the LAN and Z21 to address # 2.</p>
<hr/>
 <h3>LAN_X_GET_VERSION</h3>
<p>With the following command the X-Bus version of the Z21 can be read out.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th colspan="3">Data </th></tr>
<tr>
<td rowspan="2">0x07</td><td rowspan="2">0x00</td><td rowspan="2">0x40</td><td rowspan="2">0x00</td><th>X-Header</th><th>DB0</th><th>XOR-Byte </th></tr>
<tr>
<td>0x21</td><td>0x21</td><td>0x00 </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>response:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th colspan="5">Data </th></tr>
<tr>
<td rowspan="2">0x09</td><td rowspan="2">0x00</td><td rowspan="2">0x40</td><td rowspan="2">0x00</td><th>X-Header</th><th>DB0</th><th>DB1</th><th>DB2</th><th>XOR-Byte </th></tr>
<tr>
<td>0x63</td><td>0x21</td><td>0x30</td><td>0x12</td><td>0x60 </td></tr>
</table>
<ul>
<li>DB1 &ndash;&gt; X-Bus Version (3.0)</li>
<li>DB2 &ndash;&gt; ID (Z21 = 0x12)</li>
</ul>
<hr/>
 <h3>LAN_X_GET_STATUS</h3>
<p>with the following command the system's status can be read out.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th colspan="3">Data </th></tr>
<tr>
<td rowspan="2">0x07</td><td rowspan="2">0x00</td><td rowspan="2">0x40</td><td rowspan="2">0x00</td><th>X-Header</th><th>DB0</th><th>XOR-Byte </th></tr>
<tr>
<td>0x21</td><td>0x24</td><td>0x05 </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>response:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Headers</th><th colspan="4">Data </th></tr>
<tr>
<td rowspan="2">0x08</td><td rowspan="2">0x00</td><td rowspan="2">0x40</td><td rowspan="2">0x00</td><th>X-Header</th><th>DB0</th><th>DB1</th><th>XOR-Byte </th></tr>
<tr>
<td>0x62</td><td>0x22</td><td>CentralState</td><td>XOR-Byte </td></tr>
</table>
<p>The system status is identical to the centralState, which is supplied in SystemStatus.</p>
<dl class="section see"><dt>See also</dt><dd>Manager::getCentralState</dd></dl>
<hr/>
 <h3>LAN_X_SET_TRACK_POWER_OFF</h3>
<p>With the following command the trackpower is switched off.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Header</th><th colspan="3">Data </th></tr>
<tr>
<td rowspan="2">0x07</td><td rowspan="2">0x00</td><td rowspan="2">0x40</td><td rowspan="2">0x00</td><th>X-Header</th><th>DB0</th><th>XOR-Byte </th></tr>
<tr>
<td>0x21</td><td>0x80</td><td>0xA1 </td></tr>
</table>
<p>response: see UDPClient::broadcastPowerStateChange</p>
<hr/>
 <h3>LAN_X_SET_TRACK_POWER_ON</h3>
<p>With the following command the trackpower is switched on. This cancels a pending emergencystop or programmingmode.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Header</th><th colspan="3">Data </th></tr>
<tr>
<td rowspan="2">0x07</td><td rowspan="2">0x00</td><td rowspan="2">0x40</td><td rowspan="2">0x00</td><th>X-Header</th><th>DB0</th><th>XOR-Byte </th></tr>
<tr>
<td>0x21</td><td>0x81</td><td>0xA0 </td></tr>
</table>
<p>response: see UDPClient::broadcastPowerStateChange</p>
<hr/>
 <h3>LAN_X_GET_FIRMWARE_VERSION</h3>
<p>With this command the firmware version of the Z21 can be read out.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Header</th><th colspan="3">Data </th></tr>
<tr>
<td rowspan="2">0x07</td><td rowspan="2">0x00</td><td rowspan="2">0x40</td><td rowspan="2">0x00</td><th>X-Header</th><th>DB0</th><th>XOR-Byte </th></tr>
<tr>
<td>0xF1</td><td>0x0A</td><td>0xFB </td></tr>
</table>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Response:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Header</th><th colspan="5">Data </th></tr>
<tr>
<td rowspan="2">0x09</td><td rowspan="2">0x00</td><td rowspan="2">0x40</td><td rowspan="2">0x00</td><th>X-Header</th><th>DB0</th><th>DB1</th><th>DB2</th><th>XOR-Byte </th></tr>
<tr>
<td>0xF3</td><td>0x0A</td><td><b>V_MSB</b></td><td><b>V_LSB</b></td><td>XOR_Byte </td></tr>
</table>
<p><b>DB1</b> : Most significant byte firmware version.</p>
<p><b>DB2</b> : Least significant byte firmware version.</p>
<p>The Firmware version is in BCD format.</p>
<hr/>
 <h3>LAN_SET_LOCOMODE</h3>
<p>Set the output format for a given locomotive address. The format is stored persistently in the Z21.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Header</th><th colspan="2">Data </th></tr>
<tr>
<td>0x07</td><td>0x00</td><td>0x61</td><td>Loc-Address (16 Bit big endian)</td><td>Modus (8 Bit) </td></tr>
</table>
<p><b>Response</b> : none</p>
<p><b>Modus</b> :</p><ul>
<li>0 = DCC Format</li>
<li>1 = MM Format</li>
</ul>
<p><b>Note</b>: Each loco address &gt;= 256 is and will automatically be "DCC format".</p>
<hr/>
 <h3>LAN_SET_TURNOUTMODE</h3>
<p>Set the output format for a given function decoder address. The format is stored persistently in the Z21.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">DataLen</th><th colspan="2">Header</th><th colspan="2">Data </th></tr>
<tr>
<td>0x07</td><td>0x00</td><td>0x71</td><td>FunctionDecoder-Address (16 Bit big endian)</td><td>Modus (8 Bit) </td></tr>
</table>
<p><b>Response</b> : none</p>
<p><b>Modus</b> :</p><ul>
<li>0 = DCC Format</li>
<li>1 = MM Format</li>
</ul>
<p><b>Note</b>: Each function decoder address &gt;= 256 is and will automatically be "DCC format".</p>
<hr/>
 <h3>LAN_RAILCOM_GETDATA</h3>
<p>Request RailCom data from Z21.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Request:</caption>
<tr>
<th colspan="2">Datalen</th><th colspan="2">Header</th><th colspan="2">Data </th></tr>
<tr>
<td>0x07</td><td>0x00</td><td>0x89</td><td>0x00</td><td><b>Type</b></td><td>Loc address (16 Bit litle endian) </td></tr>
</table>
<p><b>Type</b> : 0x01 = Request RailCom data for given locomotive address</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a95d2a91c8058d1cf26c19cd8db9a2ca1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95d2a91c8058d1cf26c19cd8db9a2ca1">&#9670;&nbsp;</a></span>m_Clients</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="classIoTT_1_1Z21Client.html">Z21Client</a>*&gt; IoTT::Z21Interface::m_Clients</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a644498b25a639cc18b7a0ba1d30e15e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a644498b25a639cc18b7a0ba1d30e15e3">&#9670;&nbsp;</a></span>m_fdsock_me</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int IoTT::Z21Interface::m_fdsock_me</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad5136979b4f41f3fabdc2ee5818b0c71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5136979b4f41f3fabdc2ee5818b0c71">&#9670;&nbsp;</a></span>m_fdStop</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int IoTT::Z21Interface::m_fdStop</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac03305fbb3face4b0db005087d5fc426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac03305fbb3face4b0db005087d5fc426">&#9670;&nbsp;</a></span>m_MClients</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">recursive_mutex IoTT::Z21Interface::m_MClients</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1212b3351e13f38619bb11dc56f689cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1212b3351e13f38619bb11dc56f689cd">&#9670;&nbsp;</a></span>m_Mfdsock_me</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">recursive_mutex IoTT::Z21Interface::m_Mfdsock_me</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae978137ddd81489343ac8486d74d921a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae978137ddd81489343ac8486d74d921a">&#9670;&nbsp;</a></span>m_pDecoders</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIoTT_1_1Decoders.html">Decoders</a>* IoTT::Z21Interface::m_pDecoders</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a303f4581893ff5b9808fda50a428ef4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a303f4581893ff5b9808fda50a428ef4c">&#9670;&nbsp;</a></span>m_port</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">in_port_t IoTT::Z21Interface::m_port</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adefd2315595c417c3ed51e2ccc06edbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adefd2315595c417c3ed51e2ccc06edbc">&#9670;&nbsp;</a></span>m_sockaddr_me</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sockaddr_in IoTT::Z21Interface::m_sockaddr_me</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae87188b5116702638ac12db408cb8fa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae87188b5116702638ac12db408cb8fa2">&#9670;&nbsp;</a></span>m_thread</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">thread IoTT::Z21Interface::m_thread</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a88d755ba0c08a8c5dc79357e9093e980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88d755ba0c08a8c5dc79357e9093e980">&#9670;&nbsp;</a></span>m_TopicBasePath</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const string IoTT::Z21Interface::m_TopicBasePath</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="Z21Interface_8h_source.html">Z21Interface.h</a></li>
<li>src/<a class="el" href="Z21Interface_8cpp.html">Z21Interface.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceIoTT.html">IoTT</a></li><li class="navelem"><a class="el" href="classIoTT_1_1Z21Interface.html">Z21Interface</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
